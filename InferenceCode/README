 DMS.cpp

// 
	// Adapted for time-series analysis from Andrej Fischer, Ignacio Vazquez-Garcia, Christopher J.R. Illingworth and Ville Mustonen. High-definition reconstruction of subclonal composition in cancer. Cell Reports (2014), http://dx.doi.org/10.1016/j.celrep.2014.04.055

	// Additional features for time-resolved data: neutral exact Wright-Fisher and Gaussian propagation with absorbing boundaries drift model on a frequency grid with matrix exponentiation routine and 
 
  Input: a file with four columns (extra columns of "read depth" correspond to more replicates which are analysed independently from each other):
  
	locus time reads depth

  Each locus is treated as an independent sample from the same process (linkage is not taken into account).

  For population sizes above 1000 the routines reads precomputed matrix powers from folder ./MatPow located in the same directory
  

  Output:
  -- The posterior mean and standard deviation of the emission rate.
  -- On request (--dist), the posterior distribution at each point (may generate large files and be slow to compute!).

  Required Arguments:

  --data        The input observed data file

  --mode        Emission model:
                1 Binomial
		2 Beta-Binomial

  --GWF         0 Gaussian propagation with absorbing boundaries
		1 Wright-Fisher propagation by matrix exponentiation (2N<=1000) or pre-computed matrix powers (2N>1000)
		
  Optional Arguments:
  --pre                 The prefix to put before all output files
  --grid      [int]     The grid size for the distributions (partitions [0,1] into [grid] bins).
  --dist                Prints all the posterior distributions as well.
  --sigmai    [double]  Initial drift amplitude (default minimum value sigmai=0.01)
  --sigmaf    [double]  Final drift amplitude (default minimum value sigmaf=0.05)
  --sigmagrid [int]     number of initial points for drift parameter optimization
  --shape     [double]  To fix the shape parameter in mode 2

Example:

./DMS --data [file] --mode 1 --GWF 1 -pre [str] --sigmai 0.01 --sigmaf 0.05 --sigmagrid 5 --grid 400 


Notes:
data files should have line ending in Unix/Linux format
